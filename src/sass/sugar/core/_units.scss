//
// Units specific
//

//
// Strip units
//
@function s-strip-units($number) {
	@return $number / ($number * 0 + 1);
}

//
// Convert helpers
//
@function s-percent($value) {
	@return s-convert($value, '%');
}
@function s-px($value) {
	@return s-convert($value, px);
}
@function s-pt($value) {
	@return s-convert($value, pt);
}
@function s-rem($value) {
	@return s-convert($value, rem);
}
@function s-em($value) {
	@return s-convert($value, em);
}


//
// Convert some values
//
$_s-font-size : null;
@function s-convert($value, $convertUnit){

	// get the unit
	$unit : null;

	// get the unit
	$unit : unit($value);

	// put font size in cache to avoid
	// unit conversion recursion
	@if not $_s-font-size {
		$_s-font-size : sugar('settings.typo.font-size') !global;
		$_s-font-size : s-convert($_s-font-size, px) !global;
	}
	$font-size : s-strip-units($_s-font-size);

	// @debug(type-of($unit));
	// @debug($unit);
	// @debug(type-of($convertUnit));
	// @debug($convertUnit);
	// @debug('******');
	// @debug($font-size);

	// return the value if same units
	@if $unit and $unit == $convertUnit {
		// @debug('same unit #{$unit} => #{$convertUnit}');
		@return $value;
	}

	// strip unit of value
	$value : s-strip-units($value);

	@if $unit == null or $unit == '' {
		@if $convertUnit == px {
			@return $value + 0px;
		} @else if $convertUnit == em {
			@return $value + 0em;
		} @else if $convertUnit == rem {
			@return $value + 0rem;
		} @else if $convertUnit == pt {
			@return $value + 0pt;
		} @else if $convertUnit == '%' {
			@return percentage($values / 100);
		}
	} @else if $unit == px {
		@if $convertUnit == em {
			@return $value / $font-size + 0em;
		} @else if $convertUnit == percent or $convertUnit == '%' {
			@return percentage($value / $font-size);
		} @else if $convertUnit == rem {
			@return $value / $font-size + 0rem;
		} @else if $convertUnit == px {
			@return $value + 0px;
		} @else {
			@error("Unit #{$unit} cannot be converted to #{$convertUnit}");
			@return null;
		}
	}
	@else if $unit == em {
		@if $convertUnit == px {
			@return $value * $font-size + 0px;
		} @else if $convertUnit == "%" or $convertUnit == percent {
			@return percentage($value);
		} @else if $convertUnit == em {
			@return $value + 0em;
		} @else if $convertUnit == rem {
			@return s-strip-units($value) + 0rem;
		} @else {
			@error("Unit #{$unit} cannot be converted to #{$convertUnit}");
			@return null;
		}
	}
	@else if $unit == "%" {
		@if $convertUnit == px {
			@return $value * $font-size / 100 + 0px;
		} @else if $convertUnit == em {
			@return $value / 100 + 0em;
		} @else if $convertUnit == '%' {
			@return percentage($value);
		} @else {
			@error("Unit #{$unit} cannot be converted to #{$convertUnit}");
			@return null;
		}
	}
	@else if $unit == pt {
		@if $convertUnit == px {
			@return $value * 1.3333 + 0px;
		} @else if $convertUnit == em {
			@return $value / 12 + 0em;
		} @else if $convertUnit == "%" or $convertUnit == percent {
			@return percentage($value / 12);
		} @else if $convertUnit == pt {
			@return $value + 0pt;
		} @else {
			@error("Unit #{$unit} cannot be converted to #{$convertUnit}");
			@return null;
		}
	} @else if $unit == rem {
		@if $convertUnit == px {
			@return $value * $font-size + 0px;
		} @else if $convertUnit == rem {
			@return $value + 0rem;
		} @else if $convertUnit == pt {
			@return $value * $font-size * 0.75 + 0pt;
		}
	}
}