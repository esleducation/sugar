//
// Sugar drawer component
//

// settings
@include s-component-setup((
	drawer  					: ( 				// store all the drawer settings
		method 						: translate, 		// can be translate or position
		size  						: 400px, 			// drawer width
		side 						: left,			// the side of the drawer
		type 						: push, 			// can be reveal, push or slide
								)
));

@mixin s-drawer-opened(
	$name : null
) {
	$drawer-toggle-sel : '[data-s-drawer-toggle]';
	@if $name {
		$drawer-toggle-sel : '[data-s-drawer-toggle="#{$name}"]';
	}
	#{$drawer-toggle-sel}:checked ~ & {
		@content;
	}
}

@mixin s-drawer(
	$name,
	$size : sugar('settings.components.drawer.size'),
	$side : sugar('settings.components.drawer.side'),
	$type : sugar('settings.components.drawer.type'),
	$method : sugar('settings.components.drawer.method')
) {

	// pass in component context
	@include s-component-context('drawer') {
	
		@if $_sugar-test-arguments {
			$name : s-test-argument('s-drawer','name',string,$name);
			$size : s-test-argument('s-drawer','size',number,$size);
			$side : s-test-argument('s-drawer','side',(top,right,bottom,left),$side);
			$type : s-test-argument('s-drawer','type',(reveal,slide,push),$type);
			$method : s-test-argument('s-drawer','method',(position,translate),$method);
		}
		html, body {
			height: 100%;
		}

		[data-s-drawer-toggle] {
			position: fixed;
			top:0; left:0;
			opacity: 0;
		}

		$drawer-sel : '[data-s-drawer]';
		$drawer-overlay-sel : '[data-s-drawer-overlay]';
		$drawer-toggle-sel : '[data-s-drawer-toggle]';
		$drawer-bkg-sel : '[data-s-drawer-bkg]';
		@if $name {
			$drawer-sel : '[data-s-drawer="#{$name}"]';
			$drawer-overlay-sel : '[data-s-drawer-overlay="#{$name}"]';
			$drawer-toggle-sel : '[data-s-drawer-toggle="#{$name}"]';
			$drawer-bkg-sel : '[data-s-drawer-bkg="#{$name}"]';
		}

		#{$drawer-sel} {
			position: fixed;
			
			@if $side == left {
				@if $type == push or $type == slide {
					@if $method == translate {
						@include s-translate($size * -1);
					} @else {
						left : $size * -1;
					}
				} @else if $type == reveal {
					left: 0;
				}
			} @else if $side == right {
				@if $type == push or $type == slide {
					@if $method == translate {
						@include s-translate(0);
						left: 100%;
					} @else {
						right : $size * -1;
					}
				} @else if $type == reveal {
					right: 0;
				}
			} @else if $side == top {
				@if $type == push or $type == slide {
					@if $method == translate {
						@include s-translate(0, $size * -1);
					} @else {
						top : $size * -1;
					}
				} @else if $type == reveal {
					top: 0;
				}
			} @else if $side == bottom {
				@if $type == push or $type == slide {
					@if $method == translate {
						@include s-translate(0,0);
						top: 100%;
					} @else {
						bottom: $size * -1;
					}
				} @else if $type == reveal {
					bottom: 0;
				}
			}

			@if $side == left or $side == right {
				height: 100%;
				width: $size;
				top: 0;
			} @else if $side == top or $side == bottom {
				left : 0;
				height: $size;
				width: 100%;
			}

			z-index:0;
			overflow-x: hidden;
			overflow-y: auto;
			-webkit-overflow-scrolling: touch;
			@include s-transition();
		}
		/* actual page content pane */
		[data-s-drawer-content] {
			@include s-translate(0,0);
			width: 100%;
			@include s-transition();
			background-color: white;
			position: relative;
			z-index:3;
			@if $method == position {
				top: 0;
				left: 0;
			}
		}

		#{$drawer-overlay-sel} {
			position: fixed;
			z-index:10;
			top:0;
			left:0;
			height: 100%;
			width: 100%;
			background: rgba(255, 255, 255, 0);
			opacity: 0;
			pointer-events: none;
			@if $method == translate {
				@include s-translate(0,0);
			}
			@include s-transition();
			z-index: 4;
		}

		#{$drawer-bkg-sel} {
			position:fixed;
			top:0; left:0;
			width:100%;
			height:100%;
			z-index:1;
			visibility:hidden;
			@include s-transition();
		}

		#{$drawer-toggle-sel}:checked ~ #{$drawer-overlay-sel} {
			opacity: 1;
			pointer-events: all;
			@if $side == left {
				@if $method == translate {
					@include s-translate($size);
				} @else {
					left : $size;
				}
			} @else if $side == right {
				@if $method == translate {
					@include s-translate($size * -1);
				} @else {
					right : $size;
				}
			} @else if $side == top {
				@if $method == translate {
					@include s-translate(0, $size);
				} @else {
					top : $size;
				}
			} @else if $side == bottom {
				@if $method == translate {
					@include s-translate(0, $size * -1);
				} @else {
					bottom : $size;
				}
			}
			cursor: pointer;
		}

		#{$drawer-toggle-sel}:checked ~ #{$drawer-bkg-sel} {
			visibility: visible;
			z-index:2;
			@include s-transition(visibility 0s linear 0s);
		}

		#{$drawer-toggle-sel}:checked ~ #{$drawer-sel} {
			@if $type == slide {
				z-index: 4;
			} @else {
				z-index: 3;
			}
			@if $type == push or $type == slide {
				@if $side == left {
					@if $method == translate {
						@include s-translate(0);
					} @else {
						left : 0;
					}
				} @else if $side == right {
					@if $method == translate {
						@include s-translate($size * -1);
					} @else {
						right : 0;
					}
				} @else if $side == top {
					@if $method == translate {
						@include s-translate(0,0);
					} @else {
						top : 0;
					}
				} @else if $side == bottom {
					@if $method == translate {
						@include s-translate(0, $size * -1);
					} @else {
						bottom : 0;
					}
				}
			}
		}

		#{$drawer-toggle-sel}:checked ~ [data-s-drawer-content] {
			@if $type != slide {
				@if $side == left {
					@if $method == translate {
						@include s-translate($size);
					} @else {
						left : $size;
					}
				} @else if $side == right {
					@if $method == translate {
						@include s-translate($size * -1);
					} @else {
						right : $size;
					}
				} @else if $side == top {
					@if $method == translate {
						@include s-translate(0, $size);
					} @else {
						top : $size;
					}
				} @else if $side == bottom {
					@if $method == translate {
						@include s-translate(0, $size * -1);
					} @else {
						bottom : $size;
					}
					height: 100%;
				}
			}
			z-index:3;
		}

		@content;
	}

}